<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>Hawkular</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="keywords" content="">
    <meta name="generator" content="JBake">

    <!-- css -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/asciidoctor.css" rel="stylesheet">
    <link href="css/base.css" rel="stylesheet">
    <link href="css/tabzilla.css" rel="stylesheet">
    <link href="css/styles.css" rel="stylesheet">
    <link href="css/prettify.css" rel="stylesheet">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="js/html5shiv.min.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <!--<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="../assets/ico/apple-touch-icon-57-precomposed.png">-->
    <link rel="shortcut icon" href="favicon.ico">
    <link rel="alternate" href="feed.xml" title="Hawkular Blog - RSS" type="application/rss+xml">

  </head>
  <body onload="prettyPrint()" data-spy="scroll" data-offset="80" data-target="#toc">
    <div id="wrap">
      <div class="dropup">
        <a class="tabnav-closed" href="#" id="tab">Red Hat</a>
        <script>
            window.addEventListener('load', function() {
                 renderTabzilla("Hawkular", "https://hawkular.github.io", true );
            }, false);
        </script>
      </div>

	<!-- Fixed navbar -->
    <nav class="navbar navbar-fixed-top" role="navigation">
      <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
          <button class="navbar-toggle collapsed" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="index.html">Home</a>
        </div>
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
          <ul class="nav navbar-nav">
            <li><a href="index.html">Hawkular</a></li>
            <li>
              <a href="docs/user/getting-started.html">Getting
                  Started</a>
            </li>
            <li class=""><a href="downloads.html">Downloads</a></li>
            <li class="dropdown"><a aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown" href="#" role="button">
              Documentation
              <span class="caret"></span>
            </a>
            <ul class="dropdown-menu" role="menu">
              <li>
                <a href="docs/user/getting-started.html">User Documentation</a>
              </li>
              <li>
                <a href="docs/dev/development.html">Developer Documentation</a>
              </li>
              <li class="menu-item dropdown dropdown-submenu">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">REST API</a>
                <ul class="dropdown-menu">
                  <li class="menu-item ">
                    <a href="docs/rest/rest-alerts.html">Alerts</a>
                  </li>
                  <li class="menu-item ">
                    <a href="docs/rest/rest-inventory.html">Inventory</a>
                  </li>
                  <li class="menu-item ">
                    <a href="docs/rest/rest-metrics.html">Metrics</a>
                  </li>
                </ul>
              </li>
            </ul>
            <li class="dropdown"><a aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown" href="#" role="button">
              Community
              <span class="caret"></span>
            </a>
            <ul class="dropdown-menu" role="menu">
              <li>
                <a href="community/index.html">Home</a>
              </li>
              <li>
                <a href="community/join.html">Join</a>
              </li>
              <li>
                <a href="license.html">License</a>
              </li>
              <li>
                <a href="https://travis-ci.org/hawkular/builds">CI Builds</a>
              </li>
            </ul></li>
            <li class=""><a href="blog.html">Blog</a></li>
          </ul>
        </div>
      </div>
    </nav>


<section class="main-banner blog-mainbanner">
    <div class="container">
        <h1>Hawkular Blog</h1>
    </div>
</section>


<div class="blog-container">
            <a href="blog/2015/04/14/hawkular-monitor-agent-intro.html"><h1>Hawkular-Monitor Agent</h1></a>
            <p>14 April 2015, by John Mazzitelli</p>
            <p><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The <a href="https://github.com/hawkular/hawkular-agent">Hawkular Monitor agent</a> is in good enough shape now
to be able to blog about it.</p>
</div>
<div class="paragraph">
<p>The Hawkular Monitor agent is a Wildfly subsystem extension deployed as a module inside Wildfly.
At the time of writing, this currently works in Wildfly 8.2 Final.</p>
</div>
<div class="paragraph">
<p>You define what metrics you want to collect and what availabilty checks to make by adding metric sets and avail sets
to standalone.xml. You could also use the JBoss CLI to do this, rather than directly editing standalone.xml, if you wish.</p>
</div>
<div class="paragraph">
<p>A sample configuration <a href="https://github.com/hawkular/hawkular-agent/blob/master/hawkular-wildfly-monitor/src/main/assembly/subsystem.xml">is found here</a>.</p>
</div>
<div class="paragraph">
<p>An example of a metric to be collected is:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;metric-dmr name="heap.used"
            interval="30"
            timeUnits="seconds"
            resource="/core-service=platform-mbean/type=memory"
            attribute="heap-memory-usage#used" /&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>This defines a metric named "heap.used" which is the heap memory used by the WildFly VM.
The metric will be collected every 30 seconds.</p>
</div>
<div class="paragraph">
<p>Here is an example of an availability check:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;avail-dmr name="app-server"
           interval="30"
           timeUnits="seconds"
           resource="/"
           attribute="server-state"
           upRegex="run.*" /&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>This will look at the WildFly&#8217;s "server-state" and if its value matches the
regular expression "run.*" then this availability check will report UP. Otherwise, it will report DOWN.
If no upRegex is provided, then some simple heuristics are performed to determine the availability status
(specifically if the value is a number then a 0 is considered DOWN and non-zero is considered UP;
otherwise, if the value is the string "up" or "ok" (case insenstive) it is considered UP,
otherwise it is considered DOWN.)</p>
</div>
<div class="paragraph">
<p>The full XML Schema for the Hawkular Monitor agent subsystem configuration can be
<a href="https://github.com/hawkular/hawkular-agent/blob/master/hawkular-wildfly-monitor/src/main/resources/schema/hawkular-agent-monitor-subsystem.xsd">found here</a>.</p>
</div>
<div class="paragraph">
<p>Currently, what can be monitored or checked for availability is any resource in the WildFly management hierachy
(in the same WildFly where Hawkular Monitor agent is deployed). Future development is underway to allow the
Hawkular Monitor agent to monitor resources in remote WildFly instances, as well as remote JMX resources.</p>
</div>
<div class="paragraph">
<p>Today, you have the option to store the metric and availability data directly to a Hawkular-Metrics instance or to
a Hawkular ecosystem (this is the &lt;storage-adapter&gt; definition). As the Hawkular ecosystem is built out (specifically, as inventory is brought into the picture),
a fuller integration with Hawkular Monitor agent will be possible.</p>
</div>
<div class="paragraph">
<p>If you have any questions on this, or suggestions on what features we need to add or enhance, please ping us on
the #hawkular freenode chat room or send an email to the <a href="https://lists.jboss.org/mailman/listinfo/hawkular-dev">hawkular-dev mailing list</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="how_to_build">How To Build</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clone <a href="https://github.com/hawkular/hawkular-agent">the source code</a></p>
</li>
<li>
<p>Build via Maven: "mvn clean install"</p>
<div class="ulist">
<ul>
<li>
<p>The Wildfly module that houses the Hawkular Monitor agent will be found in a zip file under hawkular-agent/hawkular-wildfly-monitor.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Unzip the Hawkular Monitor agent into whatever Wildfly 8.2 instance you want.</p>
<div class="ulist">
<ul>
<li>
<p>Alternatively, you can use the Maven wildfly-extension-plugin to do this:</p>
<div class="ulist">
<ul>
<li>
<p>cd hawkular-agent/hawkular-wildfly-monitor</p>
</li>
<li>
<p>mvn -Dorg.hawkular.wildfly.home=/source/hawkular/kettle/target/wildfly-8.2.0.Final/ clean install wildfly-extension:deploy</p>
</li>
<li>
<p>Notice the above command installed Hawkular Monitor agent inside my Hawkular Kettle build</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dmr_client">DMR Client</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A standalone library has been included in the hawkular-agent repository that can be used to talk to a WildFly&#8217;s
management interface via a more strongly-typed API that sits above the DMR API. The
<a href="https://github.com/hawkular/hawkular-agent/tree/master/hawkular-dmr-client/src/main/java/org/hawkular/dmrclient">DMR Client</a>
provides this capability in a single-jar library. The Hawkular Monitor agent uses it, but since it is a
standalone library, anyone that wants to talk to WildFly&#8217;s management interface can use it. Currently, its snapshots are
released on Nexus which you can
<a href="https://repository.jboss.org/nexus/content/repositories/snapshots/org/hawkular/agent/hawkular-dmr-client/">find here</a>.</p>
</div>
<div class="paragraph">
<p>A simple example of its usage is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">import org.jboss.as.controller.client.ModelControllerClient;
import org.hawkular.dmrclient.Address;
import org.hawkular.dmrclient.CoreJBossASClient;

// ...

ModelControllerClient mcc = ModelControllerClient.Factory.create("myhostname", 9990);
// now use the hawkular-dmr-client library
try (CoreJBossASClient client = new CoreJBossASClient(mcc)) {
    // get version of the wildfly instance from DMR root resource "/"
    String rv = client.getStringAttribute("release-version", Address.root());

    // get install directory of the WildFly instance from DMR resource "/core-service=server-environment"
    String hd = client.getStringAttribute("home-dir", Address.parse("/core-service=server-environment"));
} catch (Exception e) {
    // do something about the error
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You no longer have to worry about how to build DMR ModelNodes in the correct format to perform these kinds of operations.
The Hawkular DMR Client API will build the ModelNode requests and process the ModelNode responses for you.</p>
</div>
<div class="paragraph">
<p>CoreJBossASClient is one of several strongly-typed API objects that extend
<a href="https://github.com/hawkular/hawkular-agent/blob/master/hawkular-dmr-client/src/main/java/org/hawkular/dmrclient/JBossASClient.java">JBossASClient</a>.
Others can be used to access common resource types in the DMR hierarchy, such as
<a href="https://github.com/hawkular/hawkular-agent/blob/master/hawkular-dmr-client/src/main/java/org/hawkular/dmrclient/DatasourceJBossASClient.java">DatasourceJBossASClient</a>
which can be used to manipulate datasources.</p>
</div>
</div>
</div></p>
            <br />
            <hr /><br />
            <br />
            <a href="blog/2015/04/09/alert-notifiers-for-mobile-devices.html"><h1>Alert notifiers for mobile devices</h1></a>
            <p>09 April 2015, by Thomas Segismont</p>
            <p><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Hawkular Alerts has new notifications senders which target mobile devices. Let&#8217;s start with a brief explanation of
notification sending.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="how_notification_senders_work">How notification senders work?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When the alert engine detects a problem, it sends an action message to the configured sender(s) for this type of issue.
The action message has all the details:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>which problem triggered the alert</p>
</li>
<li>
<p>who are the configured recipients</p>
</li>
</ul>
</div>
<div id="img-action-plugins" class="imageblock" style="text-align: center">
<div class="content">
<img src="/img/blog/2015/alert-action-plugins.png" alt="Action plugins overview" width="600">
</div>
<div class="title">Figure 1. Action plugins overview</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The alert engine inspects notification data to determine which action messages should be sent to the Hawkular bus.</p>
</li>
<li>
<p>Then it sends a message for each configured notification (email/SMS/push).</p>
</li>
<li>
<p>Action plugins pick up their messages and build the notification with the details given in the notification message.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Makes sense? Now which new plugins do we have?</p>
</div>
<div class="sect2">
<h3 id="unified_push_notifications">Unified Push Notifications</h3>
<div class="paragraph">
<p>Hawkular Alert&#8217;s <code>aerogear</code> plugin is able to send notification messages to
<a href="https://www.jboss.org/unifiedpush/">Aerogear&#8217;s Unified Push Server</a>. Which means that you can send alerts as native push
messages to an Android, iOS, Windows or Firefox OS application.</p>
</div>
<div class="paragraph">
<p>At the time of writing, Hawkular doesn&#8217;t have a mobile application for any of these platforms (an Android application
might come soon with the help of a Google Summer of Code student). So for demonstration purposes we&#8217;ve built a sample
application, <code>Hawkugear</code> and ran it with the Android Emulator.</p>
</div>
<div id="img-action-plugins" class="imageblock" style="text-align: center">
<div class="content">
<img src="/img/blog/2015/hawkugear-android-app.png" alt="Hawkugear Android application" width="350">
</div>
<div class="title">Figure 2. Hawkugear Android application</div>
</div>
<div class="paragraph">
<p>The application lacks proper formatting of course, but you can see on this screenshot that the notification message
landed properly on the mobile device after travelling through the Hawkular Bus, the Aerogear Unified Push Server and
Google Cloud&#8217;s Messaging platform.</p>
</div>
<div class="paragraph">
<p>To configure the <code>aerogear</code> sender plugin, add these system property definitions (with your own values) into your
Wildfly <code>standalone.xml</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;system-properties&gt;
    &lt;property name="org.hawkular.actions.aerogear.root.server.url" value="http://localhost:9191/ag-push/"/&gt;
    &lt;property name="org.hawkular.actions.aerogear.application.id" value="as304-6019-8a256afkbc-935b274-16247"/&gt;
    &lt;property name="org.hawkular.actions.aerogear.master.secret" value="94b2-qc156s-719725j6-4k04d566-bs0a340"/&gt;
&lt;/system-properties&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or using the CLI:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">/system-property=org.hawkular.actions.aerogear.root.server.url:add(value="http://localhost:9191/ag-push/")
/system-property=org.hawkular.actions.aerogear.application.id:add(value="as304-6019-8a256afkbc-935b274-16247")
/system-property=org.hawkular.actions.aerogear.master.secret:add(value="94b2-qc156s-719725j6-4k04d566-bs0a340")</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="short_message_service">Short Message Service</h3>
<div class="paragraph">
<p>There&#8217;s also an <code>sms</code> plugin which is built on <a href="https://www.twilio.com/sms">Twilio&#8217;s SMS services</a>. No mobile application
required here, all you need to do is to create a Twilio account and configure the plugin with your application <code>sid</code>,
authorization <code>token</code>, and <code>from</code> number.</p>
</div>
<div class="paragraph">
<p>As for the <code>aerogear</code> plugin, add these system property definitions (with your own values) into your Wildfly
<code>standalone.xml</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;system-properties&gt;
    &lt;property name="org.hawkular.actions.sms.sid" value="ACdc5f132a3c49700934481addd5ce1659"/&gt;
    &lt;property name="org.hawkular.actions.sms.token" value="3036d49cAf5Cd019c81de12354d57ac49a"/&gt;
    &lt;property name="org.hawkular.actions.sms.from" value="+14158141829"/&gt;
&lt;/system-properties&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or using the CLI:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">/system-property=org.hawkular.actions.sms.sid:add(value="ACdc5f132a3c49700934481addd5ce1659")
/system-property=org.hawkular.actions.sms.token:add(value="3036d49cAf5Cd019c81de12354d57ac49a")
/system-property=org.hawkular.actions.sms.from:add(value="+14158141829")</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="more_to_come">More to come&#8230;&#8203;</h3>
<div class="paragraph">
<p>We have planned to integrate with <a href="http://www.pagerduty.com/">PagerDuty</a>. In the beginning, each notification message
will be sent with a new indentifier. As a consequence, PagerDuty will see recurrent notifications of the same problem
as different incidents. The Hawkular Alerts team is working on an incident worflow and we should be able to solve this
problem in the near future.</p>
</div>
<div class="paragraph">
<p>That&#8217;s it! Questions? Comments? Feel free to ask here or <a href="irc://irc.freenode.net/#hawkular">join us on Freenode</a>!</p>
</div>
</div>
</div>
</div></p>
            <br />
            <hr /><br />
            <br />
            <a href="blog/2015/2015-04-08-1.html"><h1>Testing collectd integration</h1></a>
            <p>08 April 2015, by Thomas Segismont</p>
            <p><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Hawkular Metrics is able to store data coming from <a href="http://collectd.org/" target="_blank">collectd</a>. To enable this
feature, you need to start the
<a href="https://github.com/hawkular/hawkular-metrics/tree/master/clients/ptranslator" target="_blank">ptrans</a> proxy, point it
to your Metrics server, and configure the collectd network plugin to send data to ptrans.</p>
</div>
<div id="img-stack" class="imageblock">
<div class="content">
<img src="../../img/blog/2015/collectd-ptrans-metrics.png" alt="collectd/ptrans/metrics stack">
</div>
<div class="title">Figure 1. collectd/ptrans/metrics stack</div>
</div>
<div class="paragraph">
<p><a href="https://commons.wikimedia.org/wiki/File:Logo_der_Software_collectd.svg#/media/File:Logo_der_Software_collectd.svg">
collectd logo by Florian Forster. Licensed under CC BY-SA 2.0 de via Wikimedia Commons</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="regression_test_requirements">Regression test requirements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To make sure the collectd/ptrans/Hawkular stack never gets broken, we wanted to have an integration test. This test
should fill the following requirements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>do not fail the build on machines where collectd is not available (non-Linux developers machines, or simply machines
where collectd is not installed)</p>
</li>
<li>
<p>run on Travis-CI, where each pull request is tested before being merged</p>
</li>
<li>
<p>make sure all data sent from collectd lands on the Hawkular Metrics server</p>
</li>
<li>
<p>run as quickly as possible</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Here&#8217;s an outline of the implementation.</p>
</div>
<div class="sect2">
<h3 id="skip_test_when_collectd_is_not_available">Skip test when collectd is not available</h3>
<div class="paragraph">
<p><a href="https://github.com/junit-team/junit/wiki/Assumptions-with-assume" target="_blank">jUnit Assumptions</a> provide a nice way
to test the presence of external dependencies. The default jUnit runner will skip the test if the assumption fails. So
skipping the test when collectd is not available is just a matter of testing if the collectd binary exists, is a regular
file, and is executable.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">private static final String COLLECTD_PATH = System.getProperty("collectd.path", "/usr/sbin/collectd");

// ...

@Before
public void setUp() throws Exception {
    // ...
    assumeCollectdIsPresent();
    // ...
}

private void assumeCollectdIsPresent() {
    Path path = Paths.get(COLLECTD_PATH);
    assumeTrue(COLLECTD_PATH + " does not exist", Files.exists(path));
    assumeTrue(COLLECTD_PATH + " is not a file", Files.isRegularFile(path));
    assumeTrue(COLLECTD_PATH + " is not executable", Files.isExecutable(path));
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="run_on_travis_ci">Run on Travis-CI</h3>
<div class="paragraph">
<p><a href="http://docs.travis-ci.com/user/installing-dependencies/">
Travis lets you customize the virtual running the build</a>. Installing packages on the Ubuntu-based VM is very
straightforward, just add a couple of lines in the <code>before_install</code> target of your <code>.travis.yml</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-yaml" data-lang="yaml">before_install:
- sudo apt-get update -qq
- sudo apt-get install -qq collectd collectd-utils</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="verify_data_has_landed_on_the_metrics_server">Verify data has landed on the Metrics server</h3>
<div class="paragraph">
<p>collectd lets you configure one or more <em>write plugins</em>. The network plugin is required to send data to ptrans. We also
activate the csv plugin and make it log the measurements to <em>stdout</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-conf" data-lang="conf">LoadPlugin csv
&lt;Plugin csv&gt;
    DataDir stdout
&lt;/Plugin&gt;

LoadPlugin network
&lt;Plugin network&gt;
    Server "127.0.0.1" "25826"
    ReportStats false
&lt;/Plugin&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then we start collectd, preventing it to fork to the background with the <code>-f</code> option, and wait until a minimum number
of measurements has been sent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Test
public void shouldFindCollectdMetricsOnServer() throws Exception {

    // ...

    ImmutableList.Builder&lt;String&gt; collectdCmd = ImmutableList.builder();
    collectdCmd.add(COLLECTD_PATH, "-C", collectdConfFile.getAbsolutePath(), "-f");
    collectdProcessBuilder.command(collectdCmd.build());
    collectdProcess = collectdProcessBuilder.start();

    waitForCollectdValues();

    // ...

}

private void waitForCollectdValues() throws Exception {
    long c;
    do {
        Thread.sleep(MILLISECONDS.convert(1, SECONDS));
        c = Files.lines(collectdOut.toPath())
                 .filter(l -&gt; l.startsWith("PUTVAL"))
                 .collect(counting());
    } while (c &lt; MINIMUM);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When enough measurements have been collected and sent, all we need to do is to parse collectd <em>stdout</em> and compare with
server data, which can be loaded with an HTTP request.</p>
</div>
</div>
<div class="sect2">
<h3 id="run_as_quickly_as_possible">Run as quickly as possible</h3>
<div class="paragraph">
<p>At this point, all the ingredients can be combined to build an integration test. But the experience showed that running
it could take quite some time, even if the minimum number of measurements was low, and data collectd frequently (every
second).</p>
</div>
<div class="paragraph">
<p>A bit of investigation demonstrated that the test was spending an unexpected amount of time in  the
<code>waitForCollectdValues</code> method. It turned out that buffering of collectd output was the cause. To avoid it, we can use
the <code>stdbuf</code> tool from GNU <code>coreutils</code>: as explained in the manual page, it&#8217;s a tool to run a command "with modified
buffering operations for its standard streams".</p>
</div>
<div class="paragraph">
<p>With this slight modification, the test runs in a few seconds:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">File stdbuf = new File("/usr/bin/stdbuf");
ImmutableList.Builder&lt;String&gt; collectdCmd = ImmutableList.builder();
if (stdbuf.exists() &amp;&amp; stdbuf.canExecute()) {
    collectdCmd.add(stdbuf.getAbsolutePath(), "-o0", "-e0");
}
collectdCmd.add(COLLECTD_PATH, "-C", collectdConfFile.getAbsolutePath(), "-f");
collectdProcessBuilder.command(collectdCmd.build());
collectdProcess = collectdProcessBuilder.start();</code></pre>
</div>
</div>
<div class="paragraph">
<p>That&#8217;s it!</p>
</div>
</div>
</div>
</div></p>
            <br />
            <hr /><br />
            <br />
            <a href="blog/2015/2015-04-07-1.html"><h1>Hawkular-Metrics 0.3.1 release</h1></a>
            <p>07 April 2015, by Stefan Negrea</p>
            <p><div class="paragraph">
<p>Hello Everybody,</p>
</div>
<div class="paragraph">
<p>I am happy to announce a big milestone for the Hawkular Metrics project. We are releasing today for the
first time from the repository hosted by the Hawkular organization.</p>
</div>
<div class="paragraph">
<p>Major changes:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">UI</dt>
<dd>
<p>The core UI has been migrated to Hawkular UI related projects (hawkular-ui-components, hawkular, and
hawkular-ui-services). The explorer project is still available for testing purposes.</p>
</dd>
<dt class="hdlist1">REST</dt>
<dd>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Consistent error reporting and status codes usage across endpoints</p>
</li>
<li>
<p>Added Availability statistics (<a href="https://issues.jboss.org/browse/HWKMETRICS-35">HWKMETRICS-35</a>):</p>
<div class="ulist">
<ul>
<li>
<p>Total downtime duration</p>
</li>
<li>
<p>Last downtime</p>
</li>
<li>
<p>Percentage of uptime</p>
</li>
<li>
<p>Number of downtimes</p>
</li>
</ul>
</div>
</li>
<li>
<p>New Numeric Metric statistics (<a href="https://issues.jboss.org/browse/HWKMETRICS-34">HWKMETRICS-34</a>):</p>
<div class="ulist">
<ul>
<li>
<p>Average</p>
</li>
<li>
<p>Median</p>
</li>
<li>
<p>95th Percentile</p>
</li>
</ul>
</div>
</li>
<li>
<p>The REST implementation has been decoupled from the actual core logic, which paves the way for alternate REST
implementations</p>
</li>
</ol>
</div>
</dd>
<dt class="hdlist1">Core</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Large refactoring of the core classes and packages, the domain related logic has been pushed to the core layer</p>
</li>
<li>
<p>The Memory storage engine has been dropped from the project. Cassandra (embedded or standalone) is the exclusive
storage engine.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">InfluxDB Integration</dt>
<dd>
<p>  Influx Java client supports sending and reading data (it was not possible before because of the endoint URI
differences) to/from Hawkular Metrics. Other clients are not tested but should work as well.</p>
</dd>
<dt class="hdlist1">PTrans</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Configurable list of listeners (previously all collectd, ganglia, &#8230;&#8203; etc listeners were started)</p>
</li>
<li>
<p>Bug fix: send data to Metrics server if the buffer is full or no data was received recently (previously data could
sit in the buffer and wait for the buffer to be full before being sent)</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Github Release:
<a href="https://github.com/hawkular/hawkular-metrics/releases/tag/0.3.1" class="bare">https://github.com/hawkular/hawkular-metrics/releases/tag/0.3.1</a></p>
</div>
<div class="paragraph">
<p>JBoss Nexus Maven artifacts:
<a href="http://origin-repository.jboss.org/nexus/content/repositories/public/org/hawkular/metrics/" class="bare">http://origin-repository.jboss.org/nexus/content/repositories/public/org/hawkular/metrics/</a></p>
</div>
<div class="paragraph">
<p>A big "Thank you" goes to John Sanda, Thomas Segismont, Mike Thompson, and Heiko Rupp for their project contributions. Special mentions go to Jeeva Kandasamy, Jirka Kremser, and Michael Burman for their project help.</p>
</div>
<div class="paragraph">
<p>I am happy to announce that Matt Wringe joined the Hawkular Metrics team with a focus on containers and project integrations. We are looking forward to his contributions.</p>
</div>
<div class="paragraph">
<p>Any discussion, suggestions or contributions are more than welcomed; so feel free to comment on this post or join
<a href="irc://irc.freenode.net/#hawkular">#Hawkular on freenode</a>.</p>
</div></p>
            <br />
            <hr /><br />
            <br />
            <a href="blog/2015/2015-04-01-1.html"><h1>Hawkular Discontinued</h1></a>
            <p>01 April 2015, by Heiko W. Rupp</p>
            <p><div class="paragraph">
<p>Yesterday on March 31st, we had a good number of Meetings with other folks of JBoss in the new new
Red Hat office in Newcastle, called <em>The Pub</em>.
Among others we were also discussing the future of Monitoring. After all the beers^w discussions we have decided to
discontinue Hawkular.</p>
</div>
<div class="paragraph">
<p>We found out that software is always at fault:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>it does not have all the features users want</p>
</li>
<li>
<p>it is too slow (always!)</p>
</li>
<li>
<p>it uses too much memory</p>
</li>
<li>
<p>it uses too much cpu</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>So instead of investing more time and effort into Hawkular, we will replace it with this new Microservice</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public static String isHealthy(String resource) {
    return "no";
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>All the existing Hawkular source code will be donated to the 1. Association of Possibly Retired Invariant Lines of
code.</p>
</div>
<div class="paragraph">
<p>Thanks for your attention</p>
</div></p>
            <br />
            <hr /><br />
            <br />



    <div class="large-4 columns blog-post-listings">
        <h2>Older posts:</h2>
        <ul>
          <li>30 March 2015 - <a href="blog/2015/2015-03-30-1.html">Dockerized Hawkular builds available</a></li>
          <li>24 February 2015 - <a href="blog/2015/2015-02-24-1.html">The Kettle starts boiling</a></li>
          <li>16 February 2015 - <a href="blog/2015/2015-02-16-1.html">Hawkular-Metrics 0.2.7 release</a></li>
        <br/><br/>
    </div>

    <a href=feed.xml><i class="fa fa-rss"></i> RSS Feed</a>
</div>


		</div>
		<div id="push"></div>
    </div>
    
    <div id="footer">
      <div class="container">
        
      </div>
    </div>

    <section class="redhat">
      <div class="container">
        <p class="text-center">
          <a href="http://www.redhat.com/">
            <img alt="redhatlogo-white" src="/img/redhatlogo-white.png" width="130">
          </a>
        </p>
        <p class="muted credit">&copy; 2015 | Baked with <a href="http://jbake.org">JBake v2.3.2</a></p>
    <p id="forkongithubp"><span id="forkongithub">
      <a href="https://github.com/hawkular" class="bg-grey">
        Fork me on GitHub
      </a>
    </span></p>
      </div>
    </section>
    
    <!-- javascript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <!-- js -->
    <script src="js/jquery-1.11.2.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
    <script src="js/jbossorg-tabzilla.js"></script>
    <script src="js/behavior.js"></script>
    <script src="js/prettify.js"></script>

<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'hawkular';
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-61728352-1', 'auto');
  ga('send', 'pageview');
</script>

  </body>
</html>
