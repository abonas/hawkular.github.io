<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>Hawkular - BTM/RTGov Integration</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="keywords" content="">
    <meta name="generator" content="JBake">

    <!-- css -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="../../../css/bootstrap.min.css" rel="stylesheet">
    <link href="../../../css/asciidoctor.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link href="../../../css/tabzilla.css" rel="stylesheet">
    <link href="../../../css/styles.css" rel="stylesheet">
    <link href="../../../css/prettify.css" rel="stylesheet">
    <link href="../../../css/ekko-lightbox.min.css" rel="stylesheet">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
    <script src="../../../js/moment.min.js"></script>
    <script src="../../../js/jquery-1.11.2.min.js"></script>

    <!-- Fav and touch icons -->
    <!--<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="../assets/ico/apple-touch-icon-57-precomposed.png">-->
    <link rel="shortcut icon" href="../../../favicon.ico">
    
  </head>
  <body onload="prettyPrint()" data-spy="scroll" data-offset="80" data-target="#toc">
    <div id="wrap">
      <div class="dropup">
        <a class="tabnav-closed" href="#" id="tab">Red Hat</a>
        <script>
            window.addEventListener('load', function() {
                 renderTabzilla("Hawkular", "https://hawkular.github.io", true );
            }, false);
        </script>
      </div>

    	<!-- Fixed navbar -->
        <nav class="navbar navbar-fixed-top" role="navigation">
          <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
              <button class="navbar-toggle collapsed" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="../../../index.html">Home</a>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
              <ul class="nav navbar-nav">
                <li><a href="../../../index.html">Hawkular</a></li>
                <li><a href="../../../docs/overview.html">Overview</a></li>
                <li><a href="../../../docs/user/quick-start.html">Quick Start</a></li>
                <li class=""><a href="../../../downloads.html">Downloads</a></li>
                <li class="dropdown"><a aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown" href="#" role="button">
                  Documentation
                  <span class="caret"></span>
                </a>
                <ul class="dropdown-menu" role="menu">
                  <li>
                    <a href="../../../docs/user/user-guide.html">User Guide</a>
                  </li>
                  <li>
                    <a href="../../../docs/user/installation-guide.html">Installation Guide</a>
                  </li>
                  <!--li>
                    <a href="../../../docs/dev/terms.html">Used Terms</a>
                  </li-->
                  <li class="menu-item dropdown dropdown-submenu">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">REST API</a>
                    <ul class="dropdown-menu">
                      <li class="menu-item ">
                        <a href="../../../docs/rest/rest-alerts.html">Alerts</a>
                      </li>
                      <li class="menu-item ">
                        <a href="../../../docs/rest/rest-btm.html">Business Transaction Management</a>
                      </li>
                        <li class="menu-item ">
                            <a href="../../../docs/rest/rest-datamining.html">Data Mining</a>
                        </li>
                      <li class="menu-item ">
                        <a href="../../../docs/rest/rest-inventory.html">Inventory</a>
                      </li>
                      <li class="menu-item ">
                        <a href="../../../docs/rest/rest-metrics.html">Metrics</a>
                      </li>
                    </ul>
                  </li>
                  <li class="menu-item dropdown dropdown-submenu">
                    <a href="javascript:;" onclick="return false;" class="dropdown-toggle" data-toggle="dropdown">Sub-projects</a>
                    <ul class="dropdown-menu">
                      <li class="menu-item ">
                        <a href="../../../docs/components/alerts/index.html">Alerts</a>
                      </li>
                      <li class="menu-item ">
                        <a href="../../../docs/components/btm/index.html">Business Transaction Management</a>
                      </li>
                      <li class="menu-item ">
                        <a href="../../../docs/components/datamining/index.html">Data Mining</a>
                      </li>
                      <li class="menu-item ">
                        <a href="../../../docs/components/inventory/index.html">Inventory</a>
                      </li>
                      <li class="menu-item ">
                        <a href="../../../docs/components/metrics/index.html">Metrics</a>
                      </li>
                    </ul>
                  </li>
                </ul>
                <li class="dropdown"><a aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown" href="#" role="button">
                  Community
                  <span class="caret"></span>
                </a>
                <ul class="dropdown-menu" role="menu">
                  <li>
                    <a href="../../../community/index.html">Home</a>
                  </li>
                  <li>
                    <a href="../../../community/join.html">Join</a>
                  </li>
                  <li>
                    <a href="../../../license.html">License</a>
                  </li>
                  <li>
                    <a href="../../../docs/dev/development.html">Developer Guide</a>
                  </li>
                  <li>
                    <a href="https://travis-ci.org/hawkular">CI Builds</a>
                  </li>
                </ul></li>
                <li class=""><a href="../../../blog.html">Blog</a></li>
              </ul>
            </div>
          </div>
        </nav>

      <section class="main-banner">
        <div class="container">
          <h1>BTM/RTGov Integration</h1>
          <p>Hawkular Business Transaction Management</p>
        </div>
      </section>

	<!--<p><em>14 August 2015</em></p>-->

	<section>
      <div class="container">
        <div id="preamble">
<div class="sectionbody">
<div id="toc" class="toc">
<div id="toctitle" class="title"></div>
<ul class="sectlevel1">
<li><a href="#_introduction">Introduction</a></li>
<li><a href="#_installation">Installation</a>
<ul class="sectlevel2">
<li><a href="#_wildfly">Wildfly</a></li>
<li><a href="#_eap">EAP</a></li>
</ul>
</li>
<li><a href="#_instrumenting_the_execution_environment">Instrumenting the Execution Environment</a></li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Hawkular BTM (Business Transaction Management) project is designed to capture the structure of a business transaction instance as it executes across a series of distributed applications/services, potentially hosted on-promises and/or cloud.</p>
</div>
<div class="paragraph">
<p>The RTGov (Runtime Governance) project was designed to apply governance policies to the execution of business transactions in realtime - this was achieved based on the collection of signicant events which were used to trigger policies locally (within the execution environment) or on the RTGov activity server.</p>
</div>
<div class="paragraph">
<p>Although they have many similarities, the information collected by BTM is far more structured and designed to make it easy to analyse an end-to-end business transaction instance more efficiently in realtime.</p>
</div>
<div class="paragraph">
<p>RTGov does provide the ability to view a business transaction instance as a 'call trace', but this is <em>reverse engineered</em> from the raw activity events after the fact, and on-demand (i.e. not in realtime).</p>
</div>
<div class="paragraph">
<p>RTGov requires explicit interceptors to be introduced into the execution environment, whereas BTM is completely non-invasive, offering greater opportunity to instrument a wider range of execution technologies based on the JVM.</p>
</div>
<div class="paragraph">
<p>What BTM currently lacks is server side support for visualising captured information - which is an area that RTGov can provide. Due to the similarity of the information they are collecting, it makes it possible for BTM data to be translated into RTGov Activity Units and processed by the RTGov server.</p>
</div>
<div class="paragraph">
<p>This section will explain how to setup a BTM collector and the RTGov server, to enable the BTM information to be reported to RTGov.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installation">Installation</h2>
<div class="sectionbody">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Before trying out BTM on a server configured with either RTGov client or server, it is necessary to disable collection of activity events by RTGov. This can be achieved by setting the <em>ActivityCollector.enabled</em> property to false, in the  <em>standalone/configuration/overlord-rtgov.properties</em> or <em>standalone/configuration/standalone-full.xml</em> file.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_wildfly">Wildfly</h3>
<div class="paragraph">
<p>As of RTGov version 2.2.0.Alpha1, the BTM to RTGov gateway and necessary scripts and configuration files are included as part of the distribution.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You may need to edit the environment script <em>bin/btm-client-env.sh</em> to change the location of the BTM (i.e. BTM/RTGov gateway), and also the username and password.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_eap">EAP</h3>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
The gateway has only been tested with the latest version of RTGov running in EAP 6.4.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Then install the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Download the latest stable version of <a href="https://repository.jboss.org/nexus/index.html#nexus-search;quick~hawkular-btm-client-rest">hawkular-btm-client-rest.jar</a> into <em>standalone/lib</em></p>
</li>
<li>
<p>Download the latest stable version of <a href="https://repository.jboss.org/nexus/index.html#nexus-search;quick~rtgov-btm-eap">rtgov-btm-eap.war</a> into <em>standalone/deployments</em></p>
</li>
<li>
<p>Download and unpack the latest stable version of <a href="https://repository.jboss.org/nexus/index.html#nexus-search;quick~hawkular-btm-btxn-instrumentation">hawkular-btm-btxn-instrumentation.jar</a> into <em>standalone/data/btmconfig</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The final step is to create the environment script in the <em>bin</em> folder, in a file called <em>btm-client-env.sh</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-shell" data-lang="shell"># Environment script for setting up the JAVA_OPTS property for client instrumentation

export BTM_CLIENT_JAR_PATH=$JBOSS_HOME/standalone/lib/hawkular-btm-client-rest.jar

export JAVA_OPTS="-Dorg.jboss.byteman.transform.all \
    -javaagent:$BTM_CLIENT_JAR_PATH=manager:org.hawkular.btm.client.manager.ClientManager,boot:$BTM_CLIENT_JAR_PATH \
    -Dorg.jboss.byteman.compileToBytecode \
    -Dhawkular-btm.config=$JBOSS_HOME/standalone/data/btmconfig \
    -Dhawkular-btm.base-uri=http://localhost:8080/hawkular/btm \
    -Dhawkular-btm.username=admin \
    -Dhawkular-btm.password=admin"

# Wildfly specific
export JAVA_OPTS="$JAVA_OPTS -Djboss.modules.system.pkgs=org.jboss.byteman,org.hawkular.btm.client.manager,org.hawkular.btm.client.api"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You may need to edit the environment script to change the location of the BTM (i.e. BTM/RTGov gateway), and also the username and password.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_instrumenting_the_execution_environment">Instrumenting the Execution Environment</h2>
<div class="sectionbody">
<div class="paragraph">
<p>From a command window, that will be used to run the execution environment to be instrumented, run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-shell" data-lang="shell">export JBOSS_HOME=&lt;RTGov server directory&gt;

. $JBOSS_HOME/bin/btm-client-env.sh</code></pre>
</div>
</div>
</div>
</div>
      </div>
    </section>

		</div>
		<div id="push"></div>
    </div>

    <section class="redhat clearfix">
      <div class="container">
        <p class="pull-left">
          <a href="http://www.redhat.com/">
            <img alt="redhatlogo-white" src="../../..//img/redhatlogo-white.png" width="130">
          </a>
        </p>
        <p class="muted credit pull-right">&copy; 2015 | Hawkular is released under <a href="/license.html">Apache License v2.0</a></p>
    <p id="forkongithubp"><span id="forkongithub">
      <a href="https://github.com/hawkular" class="bg-grey">
        Fork me on GitHub
      </a>
    </span></p>
      </div>
    </section>

    <!-- javascript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <!-- js -->
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
    <script src="../../../js/jbossorg-tabzilla.js"></script>
    <script src="../../../js/behavior.js"></script>
    <script src="../../../js/prettify.js"></script>
    <script src="../../../js//ekko-lightbox.min.js"></script>

<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'hawkular';
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-61728352-1', 'auto');
  ga('send', 'pageview');
</script>

  </body>
</html>
